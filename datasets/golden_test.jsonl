{"test_case_id": "atom_4554e447-425c-46fb-ac80-582aac8158f0", "source": "supabase_knowledge_atoms", "equipment": {"manufacturer": "Unknown", "model": "Unknown", "subsystem": "General"}, "input": {"fault_code": "UNKNOWN", "fault_description": "Table with 15 rows and 16 columns", "sensor_data": {}, "context": "# task 4\nconfiguration\nstatus\nwatchdog\nprogram 32\nam 1\nprogram (local)\nin routine tags\nlt routine\n\n| None | None | None | None | None | task 4\nconfiguration\nstatus\nwatchdog\nprogram 32\nam 1\nprogram (local)\nin routine tags\nlt routine | None | None | None | None | None | None | None | None | None | None |\n| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |\n| None | None | None |  | None | configuration\nstatus\nwatchdog\nprogram 32\nam 1\nprogram (local)\nin routine tags\nlt routine | None | None | None | None | None | None | None | None | None | None |\n| None |  | None |  | None | configuration\nstatus\nwatchdog\nprogram 32\nam 1\nprogram (local)\nin routine tags\nlt routine | None | None | None | None | None | None | None | None | None | None |\n| task 1\nconfiguration\nstatus\nwatchdog\nprogram 32\nprogram 1\nprogram (local)\nmain routine tags\nfault routine\nother routines | sk 1 | None |  | None | configuration\nstatus\nwatchdog\nprogram 32\nam 1\nprogram (local)\nin "}, "expected_output": {"root_cause": "# task 4\nconfiguration\nstatus\nwatchdog\nprogram 32\nam 1\nprogram (local)\nin routine tags\nlt routine\n\n| None | None | None | None | None | task 4\nconfiguration\nstatus\nwatchdog\nprogram 32\nam 1\nprogram (lo", "safety_critical_warnings": [], "repair_steps": [], "manual_citations": [], "business_impact": {"safety_critical": false}}, "metadata": {"atom_id": "4554e447-425c-46fb-ac80-582aac8158f0", "exported_at": "2025-12-29T05:52:18.960734", "needs_review": true, "content_length": 2485}}
{"test_case_id": "atom_011a0ac5-847c-4333-9c9b-902a8e01f2ac", "source": "supabase_knowledge_atoms", "equipment": {"manufacturer": "Unknown", "model": "Unknown", "subsystem": "General"}, "input": {"fault_code": "UNKNOWN", "fault_description": "Table with 2 rows and 32 columns", "sensor_data": {}, "context": "# \n\n|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |\n| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |\n| Fault_Code_Value | None | None | None | None | None | None | None | None | None | None | None | None | None | None | None | reserved | None | None | None | None | None | None | None | None | None | None | None |  |  |  |  |\n| reserved | None | None | None | FaultCode | None | None | FaultInfo | None | None | None | None | None | None | None | None | None | None | None | None | None | None | None | None | None | None | None | None | None | None | None | None |"}, "expected_output": {"root_cause": "# \n\n|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |\n| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |", "safety_critical_warnings": [], "repair_steps": [], "manual_citations": [], "business_impact": {"safety_critical": false}}, "metadata": {"atom_id": "011a0ac5-847c-4333-9c9b-902a8e01f2ac", "exported_at": "2025-12-29T05:52:18.960734", "needs_review": true, "content_length": 761}}
{"test_case_id": "atom_96576ff2-9a2d-4df2-bda3-8473bed71ba4", "source": "supabase_knowledge_atoms", "equipment": {"manufacturer": "Unknown", "model": "Unknown", "subsystem": "General"}, "input": {"fault_code": "UNKNOWN", "fault_description": "Table with 7 rows and 2 columns", "sensor_data": {}, "context": "# Bit / Description\n\n| Bit | Description |\n| --- | --- |\n| 0 | Run |\n| 1 | Fault |\n| 2 | Disable Network |\n| 3 | Reserved(1) |\n| 4 | Reset |\n| 5 to 15 | Reserved(1) |\n| 16 to 31 | Reserved(1) |"}, "expected_output": {"root_cause": "# Bit / Description\n\n| Bit | Description |\n| --- | --- |\n| 0 | Run |\n| 1 | Fault |\n| 2 | Disable Network |\n| 3 | Reserved(1) |\n| 4 | Reset |\n| 5 to 15 | Reserved(1) |\n| 16 to 31 | Reserved(1) |", "safety_critical_warnings": [], "repair_steps": [], "manual_citations": [], "business_impact": {"safety_critical": false}}, "metadata": {"atom_id": "96576ff2-9a2d-4df2-bda3-8473bed71ba4", "exported_at": "2025-12-29T05:52:18.960734", "needs_review": true, "content_length": 193}}
{"test_case_id": "atom_6c2f3ceb-2f79-4d83-a1ec-bb7a9a5d5a21", "source": "supabase_knowledge_atoms", "equipment": {"manufacturer": "Unknown", "model": "Unknown", "subsystem": "General"}, "input": {"fault_code": "1000", "fault_description": "Table with 13 rows and 16 columns", "sensor_data": {}, "context": "# Specification Table (Page 145)\n\n| None | None | None | None | None | Task 32\nConfiguration\nStatus\nWatchdog\nProgram 1000\ngram 1\nProgram (Local\nTags and\nin Routine\nParameters)\nlt Routine\nOther | None | None | None | None | None | None | None | None | None | None |\n| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |\n| None | None | None |  | None | Configuration\nStatus\nWatchdog\nProgram 1000\ngram 1\nProgram (Local\nTags and\nin Routine\nParameters)\nlt Routine\nOther | None | None | None | None | None | None | None | None | None | None |\n| None |  | None |  | None | Configuration\nStatus\nWatchdog\nProgram 1000\ngram 1\nProgram (Local\nTags and\nin Routine\nParameters)\nlt Routine\nOther | None | None | None | None | None | None | None | None | None | None |\n| Task 1\nConfiguration\nStatus\nWatchdog\nProgram 1000\nProgram 1\nProgram (Local\nTags and\nMain Routine\nParameters)\nFault Routine\nOther\nRoutines | ask | None | 1 | None | Configuration\nStatus\nWatchdog\nProgram"}, "expected_output": {"root_cause": "# Specification Table (Page 145)\n\n| None | None | None | None | None | Task 32\nConfiguration\nStatus\nWatchdog\nProgram 1000\ngram 1\nProgram (Local\nTags and\nin Routine\nParameters)\nlt Routine\nOther | None", "safety_critical_warnings": [], "repair_steps": [], "manual_citations": [], "business_impact": {"safety_critical": false}}, "metadata": {"atom_id": "6c2f3ceb-2f79-4d83-a1ec-bb7a9a5d5a21", "exported_at": "2025-12-29T05:52:18.960734", "needs_review": true, "content_length": 2418}}
{"test_case_id": "atom_b534f03e-fea7-4ce8-bf20-9eb61cf0b653", "source": "supabase_knowledge_atoms", "equipment": {"manufacturer": "Unknown", "model": "Unknown", "subsystem": "General"}, "input": {"fault_code": "1000", "fault_description": "Table with 13 rows and 15 columns", "sensor_data": {}, "context": "# Specification Table (Page 146)\n\n| None | None | None | None | None | Task 32\nConfiguration\nStatus\nWatchdog\nProgram 1000\nram 1\nProgram (Local\nTags and\nn Routine\nParameters)\nlt Routine\nOther | None | None | None | None | None | None | None | None | None |\n| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |\n| None | None | None |  | None | Configuration\nStatus\nWatchdog\nProgram 1000\nram 1\nProgram (Local\nTags and\nn Routine\nParameters)\nlt Routine\nOther | None | None | None | None | None | None | None | None | None |\n| None |  | None |  | None | Configuration\nStatus\nWatchdog\nProgram 1000\nram 1\nProgram (Local\nTags and\nn Routine\nParameters)\nlt Routine\nOther | None | None | None | None | None | None | None | None | None |\n| Task 1\nConfiguration\nStatus\nWatchdog\nProgram 1000\nProgram 1\nProgram (Local\nTags and\nMain Routine\nParameters)\nFault Routine\nOther\nRoutines | Task | None | 1 | None | Configuration\nStatus\nWatchdog\nProgram 1000\nram 1\nProgram (Local\nTags "}, "expected_output": {"root_cause": "# Specification Table (Page 146)\n\n| None | None | None | None | None | Task 32\nConfiguration\nStatus\nWatchdog\nProgram 1000\nram 1\nProgram (Local\nTags and\nn Routine\nParameters)\nlt Routine\nOther | None |", "safety_critical_warnings": [], "repair_steps": [], "manual_citations": [], "business_impact": {"safety_critical": false}}, "metadata": {"atom_id": "b534f03e-fea7-4ce8-bf20-9eb61cf0b653", "exported_at": "2025-12-29T05:52:18.960734", "needs_review": true, "content_length": 2308}}
{"test_case_id": "atom_41ad9b8a-3c1a-4c62-9b1a-292c30cbe67c", "source": "supabase_knowledge_atoms", "equipment": {"manufacturer": "Unknown", "model": "Unknown", "subsystem": "General"}, "input": {"fault_code": "1000", "fault_description": "Table with 15 rows and 16 columns", "sensor_data": {}, "context": "# Specification Table (Page 149)\n\n| None | None | None | None | None | Task 32\nConfiguration\nStatus\nWatchdog\nProgram 1000\nm 1\nProgram (Local\nTags and\nn Routine\nParameters)\nt Routine | None | None | None | None | None | None | None | None | None | None |\n| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |\n| None | None | None |  | None | Configuration\nStatus\nWatchdog\nProgram 1000\nm 1\nProgram (Local\nTags and\nn Routine\nParameters)\nt Routine | None | None | None | None | None | None | None | None | None | None |\n| None |  | None |  | None | Configuration\nStatus\nWatchdog\nProgram 1000\nm 1\nProgram (Local\nTags and\nn Routine\nParameters)\nt Routine | None | None | None | None | None | None | None | None | None | None |\n| Task 1\nConfiguration\nStatus\nWatchdog\nProgram 1000\nProgram 1\nProgram (Local\nTags and\nMain Routine\nParameters)\nFault Routine\nOther Routines | ask 1 | None |  | None | Configuration\nStatus\nWatchdog\nProgram 1000\nm 1\nProgram (Local\nTags an"}, "expected_output": {"root_cause": "# Specification Table (Page 149)\n\n| None | None | None | None | None | Task 32\nConfiguration\nStatus\nWatchdog\nProgram 1000\nm 1\nProgram (Local\nTags and\nn Routine\nParameters)\nt Routine | None | None | No", "safety_critical_warnings": [], "repair_steps": [], "manual_citations": [], "business_impact": {"safety_critical": false}}, "metadata": {"atom_id": "41ad9b8a-3c1a-4c62-9b1a-292c30cbe67c", "exported_at": "2025-12-29T05:52:18.960734", "needs_review": true, "content_length": 2550}}
{"test_case_id": "atom_21420111-c0f1-46c5-999c-1cedb1aae5de", "source": "supabase_knowledge_atoms", "equipment": {"manufacturer": "Unknown", "model": "Unknown", "subsystem": "General"}, "input": {"fault_code": "1000", "fault_description": "Table with 14 rows and 16 columns", "sensor_data": {}, "context": "# Specification Table (Page 151)\n\n| None | None | None | None | None | Task 32\nConfiguration\nStatus\nWatchdog\nProgram 1000\nam 1\nProgram (Local\nTags and\nn Routine\nParameters)\nlt Routine | None | None | None | None | None | None | None | None | None | None |\n| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |\n| None | None | None |  | None | Configuration\nStatus\nWatchdog\nProgram 1000\nam 1\nProgram (Local\nTags and\nn Routine\nParameters)\nlt Routine | None | None | None | None | None | None | None | None | None | None |\n| None |  | None |  | None | Configuration\nStatus\nWatchdog\nProgram 1000\nam 1\nProgram (Local\nTags and\nn Routine\nParameters)\nlt Routine | None | None | None | None | None | None | None | None | None | None |\n| Task 1\nConfiguration\nStatus\nWatchdog\nProgram 1000\nProgram 1\nProgram (Local\nTags and\nMain Routine\nParameters)\nFault Routine\nOther Routines | Task | None | 1 | None | Configuration\nStatus\nWatchdog\nProgram 1000\nam 1\nProgram (Local\n"}, "expected_output": {"root_cause": "# Specification Table (Page 151)\n\n| None | None | None | None | None | Task 32\nConfiguration\nStatus\nWatchdog\nProgram 1000\nam 1\nProgram (Local\nTags and\nn Routine\nParameters)\nlt Routine | None | None |", "safety_critical_warnings": [], "repair_steps": [], "manual_citations": [], "business_impact": {"safety_critical": false}}, "metadata": {"atom_id": "21420111-c0f1-46c5-999c-1cedb1aae5de", "exported_at": "2025-12-29T05:52:18.968804", "needs_review": true, "content_length": 2476}}
{"test_case_id": "atom_cbad503f-0211-447b-b33d-66b98c67867c", "source": "supabase_knowledge_atoms", "equipment": {"manufacturer": "Siemens", "model": "S7-1200", "subsystem": "General"}, "input": {"fault_code": "1200", "fault_description": "Table with 3 rows and 8 columns", "sensor_data": {}, "context": "# What are ANY pointers used for? / Simplification with S7-1200/1500\n\n|  | What are ANY pointers used for? |  |  |  |  |  | Simplification with S7-1200/1500 |\n| --- | --- | --- | --- | --- | --- | --- | --- |\n| Programming functions that can process\ndifferent data types | None | None | → | None | None | Functions with variant pointer as InOut\nparameter for blocks\n(see following example) | None |\n| Processing of arrays\n• for example, reading, initializing,\ncopying of elements of the same\ntype | None | None | → | None | None | Default array functions\n• Reading and writing with\n#myArray[#index] (see chapter\n3.6.2 ARRAY data type and indirect\nfield accesses)\n• Copying with MOVE_BLK (see\nchapter 2.9.1 MOVE instructions) | None |\n| • Transferring structures and\nperformant processing via absolute\naddressing\nfor example, transferring user-\ndefined structures via ANY pointer to\nfunctions | None | None | → | None | None | Transferring structures as InOut\nparameters\n• see chapter 3.3.2 Call-by-re"}, "expected_output": {"root_cause": "# What are ANY pointers used for? / Simplification with S7-1200/1500\n\n|  | What are ANY pointers used for? |  |  |  |  |  | Simplification with S7-1200/1500 |\n| --- | --- | --- | --- | --- | --- | ---", "safety_critical_warnings": [], "repair_steps": [], "manual_citations": [], "business_impact": {"safety_critical": false}}, "metadata": {"atom_id": "cbad503f-0211-447b-b33d-66b98c67867c", "exported_at": "2025-12-29T05:52:18.968804", "needs_review": true, "content_length": 1016}}
{"test_case_id": "atom_f4026571-c1eb-4139-8813-c74ddc552400", "source": "supabase_knowledge_atoms", "equipment": {"manufacturer": "Siemens", "model": "S7-1500", "subsystem": "General"}, "input": {"fault_code": "1500", "fault_description": "Table with 4 rows and 8 columns", "sensor_data": {}, "context": "# Instruction / Usage / Properties\n\n|  | Instruction |  |  | Usage |  |  | Properties |\n| --- | --- | --- | --- | --- | --- | --- | --- |\n| MOVE | None | None | Copy value | None | None | • Copies the content of the parameter on\nthe input IN to the parameter of the output\nOUT.\n• The parameters on the input and output\nmust be of the same data type.\n• Parameters can also be structured tags\n(PLC data types).\n• Copies complete arrays and structures. | None |\n| MOVE_BLK | None | None | Copy array | None | None | • Copies the content of an array to another\narray.\n• Source and target array must be of the\nsame data type.\n• Copies complete arrays and structures.\n• Copies several array elements with\nstructures as well. In addition, start and\nnumber of elements can be specified. | None |\n| UMOVE_BLK | None | None | Copies array\nwithout\ninterruption | None | None | • Copies the content of an array\nconsistently without the risk of the OB\ninterrupting the copying process.\n• Source and target array m"}, "expected_output": {"root_cause": "# Instruction / Usage / Properties\n\n|  | Instruction |  |  | Usage |  |  | Properties |\n| --- | --- | --- | --- | --- | --- | --- | --- |\n| MOVE | None | None | Copy value | None | None | • Copies the", "safety_critical_warnings": [], "repair_steps": [], "manual_citations": [], "business_impact": {"safety_critical": false}}, "metadata": {"atom_id": "f4026571-c1eb-4139-8813-c74ddc552400", "exported_at": "2025-12-29T05:52:18.968804", "needs_review": true, "content_length": 1392}}
{"test_case_id": "atom_51e2d782-30d7-439f-a1f6-08d881d24235", "source": "supabase_knowledge_atoms", "equipment": {"manufacturer": "Siemens", "model": "S7-1200", "subsystem": "General"}, "input": {"fault_code": "1200", "fault_description": "Table with 3 rows and 11 columns", "sensor_data": {}, "context": "# Error / S7-1200 / S7-1500\n\n|  |  |  |  | Error |  |  | S7-1200 |  |  | S7-1500 |\n| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |\n| 1. | None | None | Cycle monitoring time\nexceeded once | None | None | RUN | None | None | STOP\n(when OB80 is not\nconfigured) | None |\n| 2. | None | None | Cycle monitoring time\nexceeded twice | None | None | STOP | None | None | STOP | None |\n| 3. | None | None | Programming error | None | None | RUN | None | None | STOP\n(when OB121 is not\nconfigured) | None |"}, "expected_output": {"root_cause": "# Error / S7-1200 / S7-1500\n\n|  |  |  |  | Error |  |  | S7-1200 |  |  | S7-1500 |\n| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |\n| 1. | None | None | Cycle monitoring time\nexceed", "safety_critical_warnings": [], "repair_steps": [], "manual_citations": [], "business_impact": {"safety_critical": false}}, "metadata": {"atom_id": "51e2d782-30d7-439f-a1f6-08d881d24235", "exported_at": "2025-12-29T05:52:18.968804", "needs_review": true, "content_length": 516}}
{"test_case_id": "atom_fc6382d9-56ff-40f4-bc3f-5a3be4439552", "source": "supabase_knowledge_atoms", "equipment": {"manufacturer": "Unknown", "model": "Unknown", "subsystem": "General"}, "input": {"fault_code": "UNKNOWN", "fault_description": "Table with 3 rows and 3 columns", "sensor_data": {}, "context": "# Specification Table (Page 55)\n\n|  | You can | also set a default value for the size of the memory reserve for new\nthe TIA portal.\nnu bar, navigate to \"Options – Settings\" and then to \"PLC programming\nl – Download without reinitialization\". |\n| --- | --- | --- |\n| None | blocks in | None |\n| None | In the me | None |\n| None | – Genera | None |"}, "expected_output": {"root_cause": "# Specification Table (Page 55)\n\n|  | You can | also set a default value for the size of the memory reserve for new\nthe TIA portal.\nnu bar, navigate to \"Options – Settings\" and then to \"PLC programmin", "safety_critical_warnings": [], "repair_steps": [], "manual_citations": [], "business_impact": {"safety_critical": false}}, "metadata": {"atom_id": "fc6382d9-56ff-40f4-bc3f-5a3be4439552", "exported_at": "2025-12-29T05:52:18.968804", "needs_review": true, "content_length": 346}}
{"test_case_id": "atom_8b072306-8a7c-4ea4-b800-65835b139cb0", "source": "supabase_knowledge_atoms", "equipment": {"manufacturer": "Siemens", "model": "S7-1500", "subsystem": "General"}, "input": {"fault_code": "1500", "fault_description": "Table with 2 rows and 3 columns", "sensor_data": {}, "context": "# Optimized blocks: Temporary tags are initialized in each block call with the\n\n|  | Optimized blocks: Temporary tags are initialized in each block call with the |  |\n| --- | --- | --- |\n| None | default value (S7-1500 / S7-1200 firmware V4 or higher). | None |\n| None | Non-optimized blocks: Temporary tags are undefined for each call of the block. | None |"}, "expected_output": {"root_cause": "# Optimized blocks: Temporary tags are initialized in each block call with the\n\n|  | Optimized blocks: Temporary tags are initialized in each block call with the |  |\n| --- | --- | --- |\n| None | defa", "safety_critical_warnings": [], "repair_steps": [], "manual_citations": [], "business_impact": {"safety_critical": false}}, "metadata": {"atom_id": "8b072306-8a7c-4ea4-b800-65835b139cb0", "exported_at": "2025-12-29T05:52:18.968804", "needs_review": true, "content_length": 358}}
{"test_case_id": "atom_aef78441-5908-4443-b6f7-f75acbb5ec0a", "source": "supabase_knowledge_atoms", "equipment": {"manufacturer": "Unknown", "model": "Unknown", "subsystem": "General"}, "input": {"fault_code": "UNKNOWN", "fault_description": "Zero-downtime configuration changes via database-backed settings with environment variable fallback and 5-minute cache TTL", "sensor_data": {}, "context": "**Problem**: Changing agent behavior required code changes and service restarts, causing downtime and slow iteration.\n\n**Solution**: Store configuration in Supabase table with environment variable fallback. Settings cached in-memory (5-minute TTL) for performance.\n\n**Architecture**: Settings Service queries database → caches result → returns value. Fallback: Database → Environment Variable → Default Value.\n\n**Database Schema**: agent_factory_settings table with columns: category (text), key (text), value (text), description (text), updated_at (timestamptz).\n\n**Type Conversion**: Supports get_bool(), get_int(), get_float() with validation and warnings on parse failures.\n\n**Runtime Changes**: Update Supabase table via UI → call settings.reload() → new values picked up without service restart.\n\n**Pattern Origin**: Adapted from Archon's CredentialService (13.4k⭐ production system).\n\n**Files**: agent_factory/core/settings_service.py (319 lines)\n\n**Code Example:**\n```python\nfrom agent_factor"}, "expected_output": {"root_cause": "**Problem**: Changing agent behavior required code changes and service restarts, causing downtime and slow iteration.\n\n**Solution**: Store configuration in Supabase table with environment variable fal", "safety_critical_warnings": [], "repair_steps": [], "manual_citations": [], "business_impact": {"safety_critical": false}}, "metadata": {"atom_id": "aef78441-5908-4443-b6f7-f75acbb5ec0a", "exported_at": "2025-12-29T05:52:18.968804", "needs_review": true, "content_length": 1603}}
{"test_case_id": "atom_b78ea2e0-2b6b-4cad-b94b-df9f2960b328", "source": "supabase_knowledge_atoms", "equipment": {"manufacturer": "Unknown", "model": "Unknown", "subsystem": "General"}, "input": {"fault_code": "UNKNOWN", "fault_description": "Abstract base class for domain expert agents reduces implementation from 200 lines to 50 lines (75% code reduction)", "sensor_data": {}, "context": "**Problem**: Each domain expert agent (Motor Control, PLC Programming, Networking) had 200+ lines of duplicate boilerplate.\n\n**Solution**: SMEAgentTemplate abstract base class enforces standard structure. Developers implement 4 methods: analyze_query(), search_kb(), generate_answer(), score_confidence().\n\n**Architecture**: Template method pattern with fixed workflow: Query → Analysis → KB Search → Answer Generation → Confidence Scoring → Escalation Decision.\n\n**Standard Workflow**:\n1. analyze_query() extracts domain, entities, keywords, complexity\n2. search_kb() performs semantic search with reranking\n3. generate_answer() builds context and generates via LLM\n4. score_confidence() combines document relevance, answer length, keyword overlap\n5. Escalate if confidence < threshold\n\n**Benefits**: 75% less code (200→50 lines), consistent error handling, automatic escalation, standardized metadata, rapid development (30 min vs 2 hours).\n\n**Files**: agent_factory/templates/sme_agent_template.py"}, "expected_output": {"root_cause": "MEAnswer\n\nclass MotorControlSME(SMEAgentTemplate):\n    def __init__(self):\n        super().__init__(\n            name=\"Motor Control SME\",\n            domain=\"motor_control\",\n            min_confidence=0.7,\n            max_docs=10\n        )\n\n    def analyze_query(self, query: str) -> QueryAnalysis:", "safety_critical_warnings": [], "repair_steps": [], "manual_citations": [], "business_impact": {"safety_critical": false}}, "metadata": {"atom_id": "b78ea2e0-2b6b-4cad-b94b-df9f2960b328", "exported_at": "2025-12-29T05:52:18.968804", "needs_review": true, "content_length": 2231}}
{"test_case_id": "atom_cfdfacd2-46e0-4067-acf7-38cce1230f48", "source": "supabase_knowledge_atoms", "equipment": {"manufacturer": "Unknown", "model": "Unknown", "subsystem": "General"}, "input": {"fault_code": "UNKNOWN", "fault_description": "Cross-encoder reranking improves search relevance from 65% to 85% (+20% absolute improvement) using ms-marco-MiniLM model", "sensor_data": {}, "context": "**Problem**: Pure keyword/vector search retrieved irrelevant documents, leading to hallucinated answers.\n\n**Solution**: Cross-encoder reranking scores query-document pairs for better semantic relevance after initial retrieval.\n\n**Architecture**: Initial retrieval (pgvector + full-text) → 20 candidate docs → Cross-encoder scores each (query, doc) pair → Rerank by score → Return top-k.\n\n**Why Cross-Encoders Work Better**:\n- Bi-encoder (vector search): Encodes query and documents separately, fast but less accurate\n- Cross-encoder (reranking): Encodes query+document together with attention mechanism, slower but much more accurate\n\n**Model**: cross-encoder/ms-marco-MiniLM-L-6-v2 (90MB, ~50ms for 20 docs on CPU, ~10ms on GPU).\n\n**Performance**: Initial retrieval 65% relevant, after reranking 85% relevant (20% absolute improvement). Total latency: 100ms (search) + 50ms (reranking) = 150ms (acceptable for async agents).\n\n**Impact**: Better answers → higher confidence scores → fewer escalations"}, "expected_output": {"root_cause": "**Problem**: Pure keyword/vector search retrieved irrelevant documents, leading to hallucinated answers.\n\n**Solution**: Cross-encoder reranking scores query-document pairs for better semantic relevanc", "safety_critical_warnings": [], "repair_steps": [], "manual_citations": [], "business_impact": {"safety_critical": false}}, "metadata": {"atom_id": "cfdfacd2-46e0-4067-acf7-38cce1230f48", "exported_at": "2025-12-29T05:52:18.974404", "needs_review": true, "content_length": 1790}}
{"test_case_id": "atom_baf827ea-9023-43ea-ab2a-e1ade2dc46b1", "source": "supabase_knowledge_atoms", "equipment": {"manufacturer": "Unknown", "model": "Unknown", "subsystem": "General"}, "input": {"fault_code": "1200", "fault_description": "Distributed tracing + metrics + structured logging provides production visibility for 50+ autonomous agents", "sensor_data": {}, "context": "**Problem**: 50+ autonomous agents running 24/7 with no visibility into failures, costs, or performance.\n\n**Solution**: Implement distributed tracing (spans), metrics collection (histograms, counters, gauges), and structured logging.\n\n**Architecture**: Tracer.start_span() creates root span → Nested spans for LLM calls, RAG search, database queries → Each span has attributes (model, tokens, cost, duration) → Export to backend (Jaeger, Grafana).\n\n**Key Features**:\n1. Distributed Tracing: Track requests across multiple agents, visualize dependencies\n2. Metrics Collection: Operation duration histograms, error rate counters, cost gauges\n3. Structured Logging: JSON logs with metadata (query, confidence, sources, latency_ms)\n4. Cost Attribution: Track LLM costs per agent for budgeting\n\n**Usage**: Wrap operations in spans, set attributes for context, export to monitoring backend.\n\n**Files**: agent_factory/observability/tracer.py (300 lines)\n\n**Code Example:**\n```python\nfrom agent_factory.obser"}, "expected_output": {"root_cause": "**Problem**: 50+ autonomous agents running 24/7 with no visibility into failures, costs, or performance.\n\n**Solution**: Implement distributed tracing (spans), metrics collection (histograms, counters,", "safety_critical_warnings": [], "repair_steps": [], "manual_citations": [], "business_impact": {"safety_critical": false}}, "metadata": {"atom_id": "baf827ea-9023-43ea-ab2a-e1ade2dc46b1", "exported_at": "2025-12-29T05:52:18.974404", "needs_review": true, "content_length": 1901}}
{"test_case_id": "atom_3cedfd1b-00e4-48e3-ab78-8e9c609ea36f", "source": "supabase_knowledge_atoms", "equipment": {"manufacturer": "Unknown", "model": "Unknown", "subsystem": "General"}, "input": {"fault_code": "UNKNOWN", "fault_description": "Model Context Protocol enables Claude Code to discover and use task management tools automatically with zero setup", "sensor_data": {}, "context": "**Problem**: AI agents need structured access to task management, but JSON APIs require manual integration.\n\n**Solution**: Implement MCP (Model Context Protocol) server that Claude Code recognizes automatically via .mcp.json config.\n\n**Architecture**: Claude Code CLI → MCP Client (built-in) → IPC Connection (stdio) → Backlog.md MCP Server (npm global package) → Storage (backlog/tasks/*.md) → TASK.md (auto-generated view).\n\n**Protocol**: 18 MCP tools (task_create, task_edit, task_list, task_view, task_archive, etc.) + 3 resources (workflow guides).\n\n**Integration Benefits**:\n1. Zero Setup: Claude Code discovers MCP servers automatically, no API keys needed\n2. Type Safety: MCP protocol enforces schemas, compile-time errors for invalid calls\n3. Bidirectional Sync: MCP changes → TASK.md updates, human edits .md files → MCP reflects\n\n**Configuration**: .mcp.json in project root with server command, args, env vars.\n\n**Files**: Package published as backlog.md@1.28.0 on npm\n\n**Code Example:**\n"}, "expected_output": {"root_cause": "**Problem**: AI agents need structured access to task management, but JSON APIs require manual integration.\n\n**Solution**: Implement MCP (Model Context Protocol) server that Claude Code recognizes aut", "safety_critical_warnings": [], "repair_steps": [], "manual_citations": [], "business_impact": {"safety_critical": false}}, "metadata": {"atom_id": "3cedfd1b-00e4-48e3-ab78-8e9c609ea36f", "exported_at": "2025-12-29T05:52:18.974404", "needs_review": true, "content_length": 1581}}
{"test_case_id": "atom_8945bc8a-8509-40a4-a8f8-bf100bd1f073", "source": "supabase_knowledge_atoms", "equipment": {"manufacturer": "Unknown", "model": "Unknown", "subsystem": "General"}, "input": {"fault_code": "2025", "fault_description": "YAML frontmatter + Markdown content enables dual access - structured data for AI, natural language for humans", "sensor_data": {}, "context": "**Problem**: Need format readable by both AI (structured data) and humans (natural language).\n\n**Solution**: YAML frontmatter for metadata + Markdown for content. Single file serves both machines and humans.\n\n**File Structure**: Frontmatter (task_id, title, status, priority, labels, dependencies, milestone) + Markdown sections (Description, Acceptance Criteria, Implementation Plan, Notes, Related).\n\n**YAML Fields**:\n- Required: task_id, title, status, created_at, updated_at\n- Optional: description, priority, labels, assignee, dependencies, milestone, acceptance_criteria\n\n**Sync Behavior**: MCP edit → frontmatter updated + markdown section appended → TASK.md regenerated. Markdown edit → MCP reflects changes on next query.\n\n**Benefits**: Version control friendly (git diff works), human editable (any text editor), AI queryable (MCP tools), single source of truth.\n\n**Files**: backlog/tasks/*.md (one file per task)\n\n**Code Example:**\n```markdown\n---\ntask_id: task-56\ntitle: \"BUILD: LRU cache"}, "expected_output": {"root_cause": "**Problem**: Need format readable by both AI (structured data) and humans (natural language).\n\n**Solution**: YAML frontmatter for metadata + Markdown for content. Single file serves both machines and", "safety_critical_warnings": ["**YAML Fields**:\n- Required: task_id, title, status, created_at, updated_at\n- Optional: description, priority, labels, assignee, dependencies, milestone, acceptance_criteria\n\n**Sync Behavior**: MCP edit → frontmatter updated + markdown section appended → TASK"], "repair_steps": [], "manual_citations": [], "business_impact": {"safety_critical": true}}, "metadata": {"atom_id": "8945bc8a-8509-40a4-a8f8-bf100bd1f073", "exported_at": "2025-12-29T05:52:18.974404", "needs_review": true, "content_length": 1557}}
