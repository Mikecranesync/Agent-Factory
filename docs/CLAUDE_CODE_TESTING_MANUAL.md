# Claude Code GitHub Actions - Testing Manual

**Purpose:** Step-by-step guide to test your Claude Code automated PR reviews
**Time Required:** 10-15 minutes
**Prerequisites:** GitHub account with access to Agent Factory repository

---

## Quick Summary

You'll be testing whether Claude can automatically review pull requests on GitHub. Success means Claude posts a review comment within 60 seconds of creating a PR.

---

## Before You Start

**What You Need:**
- ‚úÖ Agent Factory repository on GitHub (you have this)
- ‚úÖ Anthropic API key (starts with `sk-ant-...`)
- ‚úÖ Git and GitHub CLI installed on your computer
- ‚úÖ Command line access (Terminal, PowerShell, or Command Prompt)

**If you don't have an Anthropic API key:**
1. Go to: https://console.anthropic.com/
2. Click: **API Keys** ‚Üí **Create Key**
3. Copy the key (looks like `sk-ant-api03-xxxxxxxxxxxxx`)
4. Save it somewhere safe (you'll need it in Step 1)

---

## Step 1: Add API Key to GitHub (One-Time Setup)

### 1.1 Navigate to Repository Secrets

1. Open your browser and go to: https://github.com/Mikecranesync/Agent-Factory
2. Click the **Settings** tab (top navigation)
3. In the left sidebar, click: **Secrets and variables** ‚Üí **Actions**
4. Click the green **New repository secret** button

### 1.2 Add the Secret

**Fill in the form:**
- **Name:** `ANTHROPIC_API_KEY` (type exactly as shown)
- **Secret:** Paste your API key (the one that starts with `sk-ant-...`)

**Click:** **Add secret** (green button at bottom)

### 1.3 Verify Secret Added

**What you should see:**
```
Repository secrets (1)
Name                     Updated
ANTHROPIC_API_KEY       just now
```

**If you see this** ‚Üí Success! Move to Step 2
**If you don't see this** ‚Üí Repeat Step 1.2

---

## Step 2: Create a Test Pull Request

### 2.1 Open Your Terminal

**On Windows:** Press `Win + R`, type `powershell`, press Enter
**On Mac:** Press `Cmd + Space`, type `terminal`, press Enter

### 2.2 Navigate to Agent Factory Directory

```bash
cd "C:\Users\hharp\OneDrive\Desktop\Agent Factory"
```

**Expected output:**
```
(no output - just changes directory)
```

**Verify location:**
```bash
pwd
```

**Expected output:**
```
C:\Users\hharp\OneDrive\Desktop\Agent Factory
```

### 2.3 Create Test Branch

```bash
git checkout -b test-claude-review
```

**Expected output:**
```
Switched to a new branch 'test-claude-review'
```

**If you see:** `fatal: A branch named 'test-claude-review' already exists.`
**Fix:** Use a different name:
```bash
git checkout -b test-claude-review-2
```

### 2.4 Make a Small Change

```bash
echo "# Test PR for Claude Code review" >> TEST.md
```

**Expected output:**
```
(no output - creates/updates TEST.md file)
```

### 2.5 Commit the Change

```bash
git add TEST.md
git commit -m "test: Verify Claude Code review workflow"
```

**Expected output:**
```
[test-claude-review xxxxxxx] test: Verify Claude Code review workflow
 1 file changed, 1 insertion(+)
 create mode 100644 TEST.md
```

### 2.6 Push to GitHub

```bash
git push -u origin test-claude-review
```

**Expected output:**
```
Enumerating objects: 4, done.
Counting objects: 100% (4/4), done.
Writing objects: 100% (3/3), 300 bytes | 300.00 KiB/s, done.
Total 3 (delta 0), reused 0 (delta 0)
To https://github.com/Mikecranesync/Agent-Factory.git
 * [new branch]      test-claude-review -> test-claude-review
```

### 2.7 Create Pull Request

```bash
gh pr create --title "Test: Claude Code Review" --body "Testing automated Claude reviews"
```

**Expected output:**
```
Creating pull request for test-claude-review into main in Mikecranesync/Agent-Factory

https://github.com/Mikecranesync/Agent-Factory/pull/123
```

**Copy the PR URL** (you'll need it in Step 3)

**Alternative (if `gh` command fails):**
1. Go to: https://github.com/Mikecranesync/Agent-Factory
2. You'll see a yellow banner: "test-claude-review had recent pushes"
3. Click: **Compare & pull request** (green button)
4. Fill in:
   - **Title:** Test: Claude Code Review
   - **Description:** Testing automated Claude reviews
5. Click: **Create pull request** (green button)

---

## Step 3: Verify Claude Reviews the PR

### 3.1 Open the Pull Request

**Go to the PR URL from Step 2.7**
(Example: https://github.com/Mikecranesync/Agent-Factory/pull/123)

### 3.2 Watch for Claude's Comment

**Timeframe:** Within 30-60 seconds of creating the PR

**What you should see:**

```
Claude Code commented now

Review of PR #123

‚úÖ What's Good
- Clear test commit message following conventional commit format
- Small, focused change (single file)
- Branch name follows naming convention

‚ö†Ô∏è Issues Found
None - This is a test PR

üí° Suggestions
- Consider adding more test coverage after verifying workflow
- This test file can be safely deleted after verification

üîí Security Check
No security concerns detected

---
Generated by Claude Code (claude-opus-4-5-20251101)
Cost: ~$0.08 | Turns: 2/5
```

### 3.3 Interpretation

**‚úÖ SUCCESS** if you see:
- A comment from "Claude Code" bot
- Sections: ‚úÖ What's Good, ‚ö†Ô∏è Issues, üí° Suggestions, üîí Security
- Comment appears within 60 seconds

**‚ùå FAILURE** if after 2 minutes you see:
- No comment from Claude
- OR comment says "Authentication failed"
- OR comment says "Workflow failed"

**If FAILURE** ‚Üí Go to Step 4 (Troubleshooting)
**If SUCCESS** ‚Üí Go to Step 5 (Cleanup)

---

## Step 4: Troubleshooting (If Test Failed)

### 4.1 Check Workflow Logs

```bash
gh run list --workflow claude-code-review.yml --limit 5
```

**Expected output:**
```
STATUS  TITLE                           WORKFLOW             BRANCH              EVENT        ID          ELAPSED  AGE
X       Test: Claude Code Review        Claude Code Review   test-claude-review  pull_request 1234567890  1m30s    2m
```

**Look for the STATUS column:**
- ‚úì (green checkmark) = Success
- X (red X) = Failed
- ‚óã (circle) = In progress

**View detailed logs:**
```bash
gh run view 1234567890 --log
```

### 4.2 Common Issues

#### Issue A: "Authentication failed"

**Cause:** API key not set correctly or invalid

**Fix:**
1. Go to: https://console.anthropic.com/
2. Generate a new API key
3. Repeat Step 1 (Add API Key to GitHub) with the new key
4. Re-run the test:
   ```bash
   gh run rerun 1234567890
   ```

#### Issue B: "Workflow file not found"

**Cause:** `.github/workflows/claude-code-review.yml` missing

**Fix:**
```bash
# Check if file exists
ls .github/workflows/claude-code-review.yml
```

**If file doesn't exist:**
The workflow file should have been created in a previous commit. Check git history:
```bash
git log --oneline --all | grep -i "claude"
```

#### Issue C: No workflow runs at all

**Cause:** GitHub Actions not enabled

**Fix:**
1. Go to: https://github.com/Mikecranesync/Agent-Factory/settings/actions
2. Under "Actions permissions", select: **Allow all actions and reusable workflows**
3. Click **Save**
4. Close and re-open the PR to trigger workflow

### 4.3 Still Not Working?

**Get help:**
1. Copy the workflow log output:
   ```bash
   gh run view 1234567890 --log > claude-workflow-error.txt
   ```

2. Check the error log for specific error messages

3. Common error patterns:
   - `Error: API key not found` ‚Üí Repeat Step 1
   - `Error: Rate limit exceeded` ‚Üí Wait 5 minutes, try again
   - `Error: Insufficient permissions` ‚Üí Check GitHub Actions is enabled

---

## Step 5: Cleanup (After Successful Test)

### 5.1 Close and Delete Test PR

```bash
gh pr close test-claude-review --delete-branch
```

**Expected output:**
```
‚úì Closed pull request #123 (Test: Claude Code Review)
‚úì Deleted branch test-claude-review
```

### 5.2 Delete Test File

```bash
git checkout main
git pull
rm TEST.md
git add TEST.md
git commit -m "chore: Remove test file"
git push
```

### 5.3 Return to Normal State

```bash
git checkout main
```

**Expected output:**
```
Switched to branch 'main'
Your branch is up to date with 'origin/main'.
```

---

## Step 6: Using Claude Reviews in Real Work

### 6.1 Automatic Reviews

**When Claude reviews automatically:**
- Every time you open a new PR
- Every time you push new commits to an existing PR
- Every time a PR is reopened

**No action needed** - Claude will comment automatically within 60 seconds

### 6.2 Manual Reviews

**Trigger Claude on-demand by commenting on a PR:**

```
@claude review this change
```

**Or ask specific questions:**
```
@claude check for security issues in this PR
```

```
@claude does this follow CLAUDE.md standards?
```

```
@claude review the authentication changes
```

**Claude will respond** within 30-60 seconds with a new comment

### 6.3 Interpreting Reviews

**‚úÖ What's Good**
- Positive aspects Claude found
- Good practices being followed
- No action needed - keep doing this

**‚ö†Ô∏è Issues Found**
- Problems that should be fixed before merging
- Code that doesn't follow CLAUDE.md standards
- **Action:** Fix these issues and push new commits

**üí° Suggestions**
- Optional improvements
- Best practice recommendations
- **Action:** Consider implementing, but not required

**üîí Security Check**
- Security vulnerabilities detected
- Auth/permission issues
- **Action:** Fix immediately - do NOT merge until resolved

### 6.4 Cost Monitoring

**View your API usage:**
1. Go to: https://console.anthropic.com/
2. Click: **Usage** (left sidebar)
3. See monthly costs

**Expected costs:**
- 10 PRs/month: ~$1-2
- 50 PRs/month: ~$5-10
- 200 PRs/month: ~$20-30

**Cost per review:** ~$0.08-0.15 (depends on PR size and complexity)

---

## Success Checklist

After completing this manual, you should have:

- [x] Added `ANTHROPIC_API_KEY` to GitHub secrets
- [x] Created a test PR successfully
- [x] Received an automated review from Claude within 60 seconds
- [x] Cleaned up test branch and files
- [x] Understand how to use Claude reviews in real PRs
- [x] Know how to trigger manual reviews with `@claude`

---

## Quick Reference Card

**Create PR and get automatic review:**
```bash
git checkout -b my-feature
# ... make changes ...
git add . && git commit -m "feat: My feature"
git push -u origin my-feature
gh pr create --title "Add feature" --body "Description"
# Wait 60 seconds ‚Üí Claude reviews automatically
```

**Trigger manual review:**
```
Comment on PR: @claude review this change
```

**View workflow logs:**
```bash
gh run list --workflow claude-code-review.yml --limit 5
gh run view <run-id> --log
```

**Check API usage:**
https://console.anthropic.com/ ‚Üí Usage

---

## Support

**If you get stuck:**
1. Check Step 4 (Troubleshooting)
2. View workflow logs: `gh run view <run-id> --log`
3. Verify API key is set: https://github.com/Mikecranesync/Agent-Factory/settings/secrets/actions
4. Check GitHub Actions enabled: https://github.com/Mikecranesync/Agent-Factory/settings/actions

**Documentation:**
- Setup Guide: `docs/CLAUDE_CODE_GITHUB_SETUP.md`
- Claude Code Docs: https://code.claude.com/docs/en/github-actions
- GitHub Actions Secrets: https://docs.github.com/en/actions/security-guides/encrypted-secrets

---

**Created:** 2025-12-20
**Version:** 1.0
**Author:** Claude Code
**Purpose:** User-friendly testing manual for Claude Code GitHub Actions
