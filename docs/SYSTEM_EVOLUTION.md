# RIVET SYSTEM EVOLUTION

## Current â†’ Proposed at a Glance

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         CURRENT SYSTEM           â”‚      â”‚         PROPOSED SYSTEM          â”‚
â”‚                                  â”‚      â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚      TELEGRAM BOT          â”‚  â”‚      â”‚  â”‚      TELEGRAM BOT          â”‚  â”‚
â”‚  â”‚                            â”‚  â”‚      â”‚  â”‚  + Voice (Whisper)         â”‚  â”‚
â”‚  â”‚  â€¢ Text messages           â”‚  â”‚      â”‚  â”‚  + PDF uploads             â”‚  â”‚
â”‚  â”‚  â€¢ Photo OCR               â”‚  â”‚      â”‚  â”‚  + Print Q&A               â”‚  â”‚
â”‚  â”‚  â€¢ Basic commands          â”‚  â”‚      â”‚  â”‚  + Smart commands          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚               â”‚                  â”‚      â”‚               â”‚                  â”‚
â”‚               â–¼                  â”‚      â”‚               â–¼                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚      INTENT DETECTOR       â”‚  â”‚      â”‚  â”‚   INTELLIGENT INTAKE       â”‚  â”‚
â”‚  â”‚                            â”‚  â”‚  â”€â”€â–º â”‚  â”‚                            â”‚  â”‚
â”‚  â”‚  â€¢ Classify intent         â”‚  â”‚      â”‚  â”‚  â€¢ Context extraction      â”‚  â”‚
â”‚  â”‚  â€¢ Route to SME agent      â”‚  â”‚      â”‚  â”‚  â€¢ Equipment taxonomy      â”‚  â”‚
â”‚  â”‚                            â”‚  â”‚      â”‚  â”‚  â€¢ Proactive manual search â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚      â”‚  â”‚  â€¢ Clarification engine    â”‚  â”‚
â”‚               â”‚                  â”‚      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚               â–¼                  â”‚      â”‚               â”‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚      â”‚               â–¼                  â”‚
â”‚  â”‚       SME AGENTS           â”‚  â”‚      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                            â”‚  â”‚      â”‚  â”‚     KNOWLEDGE LAYER        â”‚  â”‚
â”‚  â”‚  â€¢ Electrical              â”‚  â”‚      â”‚  â”‚                            â”‚  â”‚
â”‚  â”‚  â€¢ Mechanical              â”‚  â”‚      â”‚  â”‚  â€¢ ChromaDB vectors        â”‚  â”‚
â”‚  â”‚  â€¢ Safety                  â”‚  â”‚      â”‚  â”‚  â€¢ User prints             â”‚  â”‚
â”‚  â”‚  â€¢ Generic responses       â”‚  â”‚      â”‚  â”‚  â€¢ OEM manual library      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚      â”‚  â”‚  â€¢ Fault code database     â”‚  â”‚
â”‚               â”‚                  â”‚      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚               â–¼                  â”‚      â”‚               â”‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚      â”‚               â–¼                  â”‚
â”‚  â”‚        DATABASE            â”‚  â”‚      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                            â”‚  â”‚      â”‚  â”‚   RESPONSE SYNTHESIZER     â”‚  â”‚
â”‚  â”‚  â€¢ rivet_users             â”‚  â”‚      â”‚  â”‚                            â”‚  â”‚
â”‚  â”‚                            â”‚  â”‚      â”‚  â”‚  â€¢ Manual content          â”‚  â”‚
â”‚  â”‚                            â”‚  â”‚      â”‚  â”‚  â€¢ Safety warnings         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚      â”‚  â”‚  â€¢ Source citations        â”‚  â”‚
â”‚                                  â”‚      â”‚  â”‚  â€¢ Troubleshooting steps   â”‚  â”‚
â”‚                                  â”‚      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                  â”‚      â”‚               â”‚                  â”‚
â”‚                                  â”‚      â”‚               â–¼                  â”‚
â”‚                                  â”‚      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                                  â”‚      â”‚  â”‚      ATLAS CMMS            â”‚  â”‚
â”‚                                  â”‚      â”‚  â”‚                            â”‚  â”‚
â”‚                                  â”‚      â”‚  â”‚  â€¢ Work orders             â”‚  â”‚
â”‚                                  â”‚      â”‚  â”‚  â€¢ Assets                  â”‚  â”‚
â”‚                                  â”‚      â”‚  â”‚  â€¢ Maintenance history     â”‚  â”‚
â”‚                                  â”‚      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                  â”‚      â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Key Additions by Sprint

### 1. Rivet MVP Sprint (3-Tab)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Tab 1: BACKEND          Tab 2: FRONTEND       Tab 3: BOT+AI      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚
â”‚  â€¢ Atlas CMMS            â€¢ Landing page        â€¢ Whisper voice    â”‚
â”‚  â€¢ Work order API        â€¢ Stripe checkout     â€¢ Claude vision    â”‚
â”‚  â€¢ Asset search          â€¢ Pricing page        â€¢ Clarification    â”‚
â”‚  â€¢ User provisioning     â€¢ Success flow        â€¢ E2E tests        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Prints Sprint (2-Tab)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Tab 1: INGESTION                    Tab 2: QUERY                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”‚
â”‚  â€¢ PDF extraction                    â€¢ RAG retrieval               â”‚
â”‚  â€¢ Electrical-aware chunking         â€¢ Multi-turn Q&A              â”‚
â”‚  â€¢ ChromaDB vectorization            â€¢ Source citations            â”‚
â”‚  â€¢ /upload_print command             â€¢ /chat_print command         â”‚
â”‚  â€¢ Machine/print management          â€¢ Safety warnings             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Context Sprint (2-Tab)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Tab 1: EXTRACTION                   Tab 2: RESPONSE               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚
â”‚  â€¢ Equipment taxonomy                â€¢ Response synthesizer        â”‚
â”‚  â€¢ Context extractor                 â€¢ Telegram integration        â”‚
â”‚  â€¢ Manual indexer                    â€¢ Gap tracking                â”‚
â”‚  â€¢ Manual search                     â€¢ /upload_manual command      â”‚
â”‚  â€¢ 50+ manufacturers                 â€¢ Proactive suggestions       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## User Experience Evolution

### BEFORE (Current)
```
User: "PowerFlex is faulting"

Bot:  "I understand you're having an issue with equipment. 
       Would you like to:
       1. Create a work order
       2. Get troubleshooting help"

User: (has to explain everything again...)
```

### AFTER (With All Features)
```
User: "PowerFlex is faulting"

Bot:  "ğŸ”§ PowerFlex (Allen-Bradley VFD) - Fault Detected
       
       I need the fault code to give you specific help.
       Common PowerFlex faults:
       â€¢ F004 - Undervoltage
       â€¢ F005 - Overvoltage
       â€¢ F007 - Motor Overload
       
       What code is displaying on the drive?"

User: "F004"

Bot:  "ğŸ”§ PowerFlex - F004 (DC Bus Undervoltage)
       
       ğŸ“– From PowerFlex 520 User Manual (p.47):
       
       **Cause:** DC bus voltage dropped below threshold
       
       **Check these first:**
       1. Incoming power voltage (should be 460V Â±10%)
       2. DC bus capacitor health
       3. Loose connections on L1/L2/L3 terminals
       
       âš ï¸ SAFETY: De-energize before testing
       âš ï¸ DC bus capacitors retain voltage - wait 5+ min
       
       ğŸ“„ Source: PowerFlex 520 Manual p.47
       
       Want me to create a work order for this?"
```

---

## Data Flow (Complete)

```
                                   USER MESSAGE
                                        â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                   â”‚                   â”‚
                    â–¼                   â–¼                   â–¼
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚ VOICE  â”‚         â”‚  TEXT  â”‚         â”‚ PHOTO/ â”‚
               â”‚        â”‚         â”‚        â”‚         â”‚  PDF   â”‚
               â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                   â”‚                  â”‚                   â”‚
                   â–¼                  â”‚                   â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ WHISPER â”‚             â”‚            â”‚ OCR/INDEX â”‚
              â”‚ (voice) â”‚             â”‚            â”‚           â”‚
              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜             â”‚            â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                   â”‚                  â”‚                  â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚   CONTEXT EXTRACTOR   â”‚
                          â”‚                       â”‚
                          â”‚ â€¢ Component: VFD      â”‚
                          â”‚ â€¢ Mfr: Allen-Bradley  â”‚
                          â”‚ â€¢ Fault: F004         â”‚
                          â”‚ â€¢ Urgency: Medium     â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                 â”‚                 â”‚
                    â–¼                 â–¼                 â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ USER PRINTS â”‚   â”‚ OEM MANUALS â”‚   â”‚ KNOWLEDGE   â”‚
            â”‚ (ChromaDB)  â”‚   â”‚ (ChromaDB)  â”‚   â”‚ BASE        â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                 â”‚                 â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚  RESPONSE SYNTHESIZER â”‚
                          â”‚                       â”‚
                          â”‚ â€¢ Manual excerpt      â”‚
                          â”‚ â€¢ Troubleshoot steps  â”‚
                          â”‚ â€¢ Safety warnings     â”‚
                          â”‚ â€¢ Source citations    â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚   TELEGRAM RESPONSE   â”‚
                          â”‚                       â”‚
                          â”‚ Rich, cited, safe     â”‚
                          â”‚ response to user      â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Files Created

| File | Purpose |
|------|---------|
| `docs/SYSTEM_MAP_CURRENT.md` | Current system architecture |
| `docs/SYSTEM_MAP_PROPOSED.md` | Full proposed architecture |
| `docs/SYSTEM_EVOLUTION.md` | This comparison document |

---

## Sprint Execution Order

```
Week 1:  Rivet MVP Sprint (3-Tab)
         â”œâ”€â”€ Backend: Atlas + API
         â”œâ”€â”€ Frontend: Landing + Stripe  
         â””â”€â”€ Bot: Voice + Vision

Week 2:  Prints Sprint (2-Tab)
         â”œâ”€â”€ Ingestion: PDF â†’ Vector
         â””â”€â”€ Query: RAG + Q&A

Week 3:  Context Sprint (2-Tab)
         â”œâ”€â”€ Extraction: Taxonomy + Context
         â””â”€â”€ Response: Synthesizer + Integration

Week 4:  Integration + Testing
         â”œâ”€â”€ Merge all branches
         â”œâ”€â”€ Deploy to VPS
         â””â”€â”€ Real user testing
```
